/*!
 * @copyright &copy; Kartik Visweswaran, Krajee.com, 2014
 * @version 1.1.0
 * A dynamic strength meter for password input validation with various configurable options.
 * Inspired from [password meter](http://passwordmeter.com) created by Jeff Todnem. 
 * For more JQuery plugins visit http://plugins.krajee.com
 * For more Yii related demos visit http://demos.krajee.com
 */
(function(e){"use strict";String.prototype.strReverse=function(){var e="";for(var t=0;t<this.length;t++){e=this.charAt(t)+e}return e};var t=function(){return Math.round((new Date).getTime()+Math.random()*100)};var n=function(t,n){return t===null||t===undefined||t==[]||t===""||n&&e.trim(t)===""};var r=function(t,n){var r="#"+t.attr("id");e(r).clone(true).attr("type",n).insertAfter(r).prev().remove()};var i=function(e){if(e<=0){return 0}else if(e<=20){return 1}else if(e>20&&e<=40){return 2}else if(e>40&&e<=60){return 3}else if(e>60&&e<=80){return 4}return 5};var s=function(e,t){var n=0,r=0,i=0,s=0,o=0,u=0,a=0,f=0,l=0,c=0,h=0,p=0,d=0,v=0,m=0,g=0,y=0,b=0,w=0;var E=t.midChar,S=t.consecAlphaUC,x=t.consecAlphaLC,T=t.consecNumber;var N=t.seqAlpha,C=t.seqNumber,k=t.seqSymbol;var L=t.length,A=t.number,O=t.symbol;var M="",_="",D="",P="";var H="abcdefghijklmnopqrstuvwxyz";var B="01234567890";var j=")!@#$%^&*()";if(e){n=parseInt(e.length*L);r=e.length;var F=e.replace(/\s+/g,"").split(/\s*/);var I=F.length;var q="";for(var R=0;R<I;R++){q=F[R];if(q.toUpperCase()!=q){if(M!==""&&M+1==R){h++;m++}M=R;i++}else if(q.toLowerCase()!=q){if(_!==""&&_+1==R){p++;m++}_=R;s++}else if(q.match(/[0-9]/g)){if(R>0&&R<I-1){a++}if(D!==""&&D+1==R){d++;m++}D=R;o++}else if(q.match(/[^\w]/g)){if(R>0&&R<I-1){a++}if(P!==""&&P+1==R){v++;m++}P=R;u++}var U=false;for(var z=0;z<I;z++){if(F[R]==F[z]&&R!=z){U=true;c+=Math.abs(I/(z-R))}}if(U){l++;f=I-l;c=f?Math.ceil(c/f):Math.ceil(c)}}for(var W=0;W<23;W++){var X=H.substring(W,parseInt(W+3));var V=X.strReverse();if(e.toLowerCase().indexOf(X)!=-1||e.toLowerCase().indexOf(V)!=-1){g++;w++}}for(var W=0;W<8;W++){var X=B.substring(W,parseInt(W+3));var V=X.strReverse();if(e.toLowerCase().indexOf(X)!=-1||e.toLowerCase().indexOf(V)!=-1){y++;w++}}for(var W=0;W<8;W++){var X=j.substring(W,parseInt(W+3));var V=X.strReverse();if(e.toLowerCase().indexOf(X)!=-1||e.toLowerCase().indexOf(V)!=-1){b++;w++}}if(i>0&&i<r){n=parseInt(n+(r-i)*2)}if(s>0&&s<r){n=parseInt(n+(r-s)*2)}if(o>0&&o<r){n=parseInt(n+o*A)}if(u>0){n=parseInt(n+u*O)}if(a>0){n=parseInt(n+a*E)}if((s>0||i>0)&&u===0&&o===0){n=parseInt(n-r)}if(s===0&&i===0&&u===0&&o>0){n=parseInt(n-r)}if(l>0){n=parseInt(n-c)}if(h>0){n=parseInt(n-h*S)}if(p>0){n=parseInt(n-p*x)}if(d>0){n=parseInt(n-d*T)}if(g>0){n=parseInt(n-g*N)}if(y>0){n=parseInt(n-y*C)}if(b>0){n=parseInt(n-b*k)}if(n>100){n=100}else if(n<=0){n=r>=L?1:0}return n}return 0};var o=function(r,i){this.showMeter=i.showMeter;this.toggleMask=i.toggleMask;this.verdictClasses=i.verdictClasses;this.verdictTitles=i.verdictTitles;this.verdicts=this.generateVerdicts();this.toggleClass=n(i.toggleClass)?"kv-toggle":i.toggleClass;this.toggleTitle=i.toggleTitle;this.meterClass=n(i.meterClass)?"kv-meter":i.meterClass;this.scoreBarClass=n(i.scoreBarClass)?"kv-scorebar":i.scoreBarClass;this.scoreClass=n(i.scoreClass)?"kv-score":i.scoreClass;this.verdictClass=n(i.verdictClass)?"kv-verdict":i.verdictClass;this.containerClass=n(i.containerClass)?"kv-password":i.containerClass;this.inputClass=i.inputClass;this.inputTemplate=i.inputTemplate;this.meterTemplate=i.meterTemplate;this.mainTemplate=i.mainTemplate;this.rules=i.rules;this.$element=e(r);if(n(this.$element.attr("id"))){this.$element.attr("id",t())}this.initialValue=n(this.$element.val())?0:this.$element.val();var o=s(this.initialValue,this.rules);this.$container=this.createContainer();this.$elToggle=this.$container.find(".kv-toggle");this.$elScorebar=this.$container.find(".kv-scorebar");this.$elScore=this.$container.find(".kv-score");this.$elVerdict=this.$container.find(".kv-verdict");this.$elScoreInput=e(document.createElement("input")).attr("type","hidden").val(o);this.$container.append(this.$elScoreInput);this.paint(o);this.listen()};o.prototype={constructor:o,generateVerdicts:function(){var e=this,t=[];for(var n=0;n<6;n++){t[n]='<div class="'+e.verdictClasses[n]+'">'+e.verdictTitles[n]+"</div>"}return t},listen:function(){var e=this;e.$element.on("keyup",function(t){e.change(t,this.value)});e.$element.closest("form").on("reset",function(){e.reset()});e.$elToggle.on("change",function(){e.toggle()})},paint:function(e){var t=this,n=i(e);var r=t.verdicts[n];t.$elScore.attr("class",t.scoreClass+" "+t.scoreClass+"-"+n);t.$elScorebar.css("background-position",0-parseInt(e*4)+"px");t.$elScore.html(e+"%");t.$elVerdict.html(r)},change:function(e,t){var n=this,r=s(t,n.rules);n.$elScoreInput.val(r);n.paint(r);n.$element.trigger("strength.change")},refresh:function(){var e=this;var t=s(e.$element.val(),e.rules);e.$elScoreInput.val(t);e.paint(t)},reset:function(){var e=this,t=s(e.initialValue,e.rules);e.$elScoreInput.val(t);e.paint(t);r(e.$element,"password");e.$element.trigger("strength.reset")},toggle:function(){var e=this;var t=e.$elToggle.is(":checked")?"text":"password";r(e.$element,t);e.$element.trigger("strength.toggle")},score:function(){return this.$elScoreInput.val()},verdict:function(){var e=this,t=this.$elScoreInput.val();return i(t)},createContainer:function(){var t=this;var n=t.mainTemplate;n=n.replace("{input}",t.renderInput());n=n.replace("{meter}",t.renderMeter());var r=e(document.createElement("div")).attr({"class":t.containerClass}).html(n);t.$element.before(r);var i=r.find(".kv-temporary-input");var s=t.$element.detach();i.before(s);i.remove();return r},renderToggle:function(){var e=this;if(e.toggleMask){var t=e.$element.attr("disabled")?' disabled="true"':"";var n=e.$element.attr("readonly")?' readonly="true"':"";return'<input type="checkbox" tabindex=10000 class="'+e.toggleClass+'" title="'+e.toggleTitle+'"'+t+n+">"}return""},renderInput:function(){var e=this,t=e.inputTemplate;e.$element.removeClass(e.inputClass).addClass(e.inputClass);t=t.replace("{input}",'<div class="kv-temporary-input"></div>');t=t.replace("{toggle}",e.renderToggle());return t},renderMeter:function(){var e=this,t=e.meterTemplate;if(e.showMeter){t=t.replace("{scorebar}",'<div class="'+e.scoreBarClass+'"></div>');t=t.replace("{score}",'<div class="'+e.scoreClass+'"></div>');t=t.replace("{verdict}",'<div class="'+e.verdictClass+'"></div>');var n=e.$element.attr("disabled")?e.meterClass+" kv-disabled":e.meterClass;return'<div class="'+n+'">'+t+"</div>"}return""}};e.fn.strength=function(t){var n=Array.apply(null,arguments);var r=null;n.shift();this.each(function(){var i=e(this),s=i.data("strength"),u=typeof t==="object"&&t;if(!s){i.data("strength",s=new o(this,e.extend({},e.fn.strength.defaults,u,e(this).data())))}if(typeof t==="string"){r=s[t].apply(s,n)}});if(!r&&t!=="score"&&t!=="verdict"){r=this}return r};e.fn.strength.defaults={showMeter:true,toggleMask:true,inputTemplate:'<div class="input-group">\n{input}\n<span class="input-group-addon">{toggle}</span>\n</div>',meterTemplate:'<div class="kv-scorebar-border">{scorebar}\n{score}</div>\n{verdict}',mainTemplate:'<table class="kv-container"><tr>\n<td>{input}</td>\n<td class="kv-meter-container"W>{meter}</td>\n</tr></table>',meterClass:"kv-meter",scoreBarClass:"kv-scorebar",scoreClass:"kv-score",verdictClass:"kv-verdict",containerClass:"kv-password",inputClass:"form-control",toggleClass:"kv-toggle",toggleTitle:"Show/Hide Password",verdictTitles:{0:"Too Short",1:"Very Weak",2:"Weak",3:"Good",4:"Strong",5:"Very Strong"},verdictClasses:{0:"label label-default",1:"label label-danger",2:"label label-warning",3:"label label-info",4:"label label-primary",5:"label label-success"},rules:{midChar:2,consecAlphaUC:2,consecAlphaLC:2,consecNumber:2,seqAlpha:3,seqNumber:3,seqSymbol:3,length:4,number:4,symbol:6}};e(function(){var t=e("input.strength[type=password]");if(t.length>0){t.strength()}})})(jQuery)